<AML>
 <Item type="Form" id="41449A928F3341149788B4A17F164845" action="edit">
  <name>Workflow Signoffs</name>
  <Relationships>
   <Item type="Body" id="0FBB54ABC54A47ABB211CE1F4E9A9AC3" action="edit">
    <source_id keyed_name="Workflow Signoffs" type="Form">41449A928F3341149788B4A17F164845</source_id>
    <Relationships>
     <Item type="Field" id="7C6653CBD953451D9D63B6905FD5FE95" action="merge">
      <html_code><![CDATA[<script>
var Core_reportHTML = "<table/>";
var wfProcessId ="";
function Core_loadProcessReport()
{
  if (!document.item || !document.item.xml) return;
  var reportHTML;

  if (document.item.getAttribute("action")=="add")
  {
    reportHTML = top.aras.getResource("", "imports_core.no_workflow_signoffs_exist");
  }
  else
  {
    var q = new top.Item("tmp", "tmp");
    q.loadAML("<Item type='Workflow' action='get' select='related_id(*)'>"+
                "<source_id>"+document.item.getAttribute("id")+"</source_id>"+
                "<related_id condition='is not null'/>"+
              "</Item>");
    q = q.apply();
    if (q.getItemCount()==1)
    {
      var processItem = q.getItemByIndex(0).node.selectSingleNode("related_id/Item");
	  wfProcessId = q.getItemByIndex(0).getProperty("related_id","");
      processItem.setAttribute("item_id_for_vote_now_link", document.item.getAttribute("id"));
      var report = top.aras.getItemByKeyedName("Report", "Workflow Process History");
      reportHTML = top.aras.runClientReport(report, "", processItem);
      reportHTML = reportHTML.replace(/width=""/g, "");
      reportHTML = reportHTML.replace(/height=""/g, "");
    }
    else
    {
      reportHTML = q.getErrorDetail() +"<br>"+ q.getErrorString() +"<br>"+ q.getErrorSource();
    }
  }
  Core_reportHTML = reportHTML;

  var ifr = document.getElementById("result_iframe_frame");
  var d = ifr.contentWindow.document.open();
  d.write(reportHTML);
  d.close();
  ifr.style.visibility = "visible";
}

window.attachEvent("onload", Core_loadProcessReport);
window.attachEvent("onload", expression_WorkflowSignoffs_setExpression);
window.attachEvent("onresize", expression_WorkflowSignoffs_setExpression);

function expression_WorkflowSignoffs_setExpression()
{
  document.body.scroll = "no";
  var field = document.getElementById('result_iframe_frame');
	
  var isIE7 = (top.aras.Browser.version == 7);

  field.width = isIE7? document.body.clientWidth+16 : document.body.clientWidth;
  field.height = document.body.clientHeight-25;
}

function showWorkflowProcess()
{
  if (wfProcessId !== "")
  {
    top.aras.uiShowItem("Workflow Process", wfProcessId);
  }
}

</script>
<button type="button" onclick="showWorkflowProcess();" style="background-color:white;border:none;cursor:pointer;">
  <img src="../cbin/icons/20x15_workflow.gif" border='0' TITLE = "Show Workflow Process">
</button>
&nbsp;
<button type="button" onclick="top.aras.saveString2File(Core_reportHTML, 'export2Excel');" style="background-color:white;border:none;cursor:pointer;">
  <img src="../cbin/icons/16x16_icon_msExcel.gif" border='0' TITLE = "Export To Excel">
</button>
&nbsp;
<button type="button" onclick="top.aras.saveString2File(Core_reportHTML, 'export2Word');" style="background-color:white;border:none;cursor:pointer;">
  <img src="../cbin/icons/16x16_icon_msWord.gif" border='0' TITLE = "Export To Word">
</button>

]]></html_code>
      <name>calculate_html</name>
      <positioning>absolute</positioning>
      <sort_order>128</sort_order>
      <source_id keyed_name="0FBB54ABC54A47ABB211CE1F4E9A9AC3" type="Body">0FBB54ABC54A47ABB211CE1F4E9A9AC3</source_id>
      <tab_stop>1</tab_stop>
      <x>2</x>
      <y>0</y>
     </Item>
    </Relationships>
   </Item>
  </Relationships>
 </Item>
</AML>