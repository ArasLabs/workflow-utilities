// ##########################// This function can be insterted into "InBasket VoteDialog.aspx"  in the Aras Code Tree//   ...Innovator/Client/scripts/InBasket//// Then it must be called from the initialization function.// ##########################  function handleLockedWFControlledItem(wfProcessId)  {    // based on the workflow process ID it queries the Server to get the workflow controlled item (i.e. the Express ECO item)	// then it checks the LockStatus. If locked by current user, it provides an option to unlock    var amlCmd = "<Item type='Workflow' action='get' select='source_type,source_id(owned_by_id),related_id(*)'>";    amlCmd = amlCmd + "<related_id>" + wfProcessId + "</related_id>";    amlCmd = amlCmd + "<source_id condition='is not null'/>";    amlCmd = amlCmd + "</Item>";    var q = top.aras.newIOMItem("","");    q.loadAML(amlCmd);    var res = q.apply();    if (res.isError()) {return;}      var wfControlledItemType = res.getItemByIndex(0).getPropertyAttribute("source_type","keyed_name","");     var wfControlledItemId = res.getItemByIndex(0).getProperty("source_id","invalid");     amlCmd = "<Item type='" + wfControlledItemType + "' action='get' ";    amlCmd = amlCmd + "select='item_number,state,locked_by_id'>";    amlCmd = amlCmd + "<id>" + wfControlledItemId + "</id>";    amlCmd = amlCmd + "</Item>";    q = top.aras.newIOMItem("","");    q.loadAML(amlCmd);    res = q.apply();    if (res.isError()) {return;}		if (res.getLockStatus() === 1)	{       if(confirm("Controlled Item '"+ wfControlledItemType + "' ("+ res.getProperty("item_number","") +") is still locked by you ! Do you want to unlock it ?"))       {	     q = top.aras.newIOMItem(wfControlledItemType,"unlock");		 q.setID(wfControlledItemId);         res = q.apply();         if (res.isError()) {return;}  // unlock failed	     return;	   }	}  }